{"version":3,"file":"static/js/56.1b1e30e9.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/2d/layers/TileLayerView2D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import i from\"../../../core/Logger.js\";import{isAbortError as t}from\"../../../core/promiseUtils.js\";import{watch as r}from\"../../../core/reactiveUtils.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import{equals as l}from\"../../../geometry/support/spatialReferenceUtils.js\";import{GraphicsCollection as h}from\"../../../support/GraphicsCollection.js\";import\"../../../core/Error.js\";import\"../../../core/has.js\";import\"../../../core/scheduling.js\";import\"../../../request.js\";import\"../../../chunks/index2.js\";import\"../../../core/urlUtils.js\";import\"../../../chunks/index3.js\";import\"../../../layers/effects/EffectView.js\";import\"../engine/DisplayObject.js\";import\"../engine/webgl/effects/highlight/HighlightGradient.js\";import\"../engine/webgl/BufferPool.js\";import\"../engine/webgl/enums.js\";import\"../engine/webgl/brushes/BrushBitmap.js\";import\"../../../chunks/vec4f32.js\";import\"../engine/webgl/Utils.js\";import\"../engine/webgl/shaders/BackgroundPrograms.js\";import\"../../webgl/enums.js\";import\"../../webgl/checkWebGLError.js\";import\"../../webgl/context-util.js\";import\"../../../chunks/builtins.js\";import\"../../../core/RandomLCG.js\";import\"../engine/webgl/materialKey/MaterialKey.js\";import\"../engine/webgl/techniques/Technique.js\";import\"../engine/webgl/techniques/dotDensity/TechniqueDotDensity.js\";import\"../engine/webgl/techniques/heatmap/TechniqueHeatmap.js\";import\"../engine/webgl/techniques/pieChart/TechniquePieChart.js\";import\"../../webgl/BufferObject.js\";import\"../../webgl/FramebufferObject.js\";import\"../../webgl/Texture.js\";import\"../../webgl/VertexArrayObject.js\";import\"../engine/webgl/brushes/WGLBrushHeatmap.js\";import\"../engine/webgl/DefaultVertexAttributeLayouts.js\";import\"../engine/webgl/shaders/TileInfoPrograms.js\";import\"../engine/webgl/brushes/WGLGeometryBrushMarker.js\";import\"../../../core/mathUtils.js\";import\"../engine/webgl/number.js\";import\"../engine/vectorTiles/style/StyleDefinition.js\";import\"../../../chunks/vec2f32.js\";import\"../engine/vectorTiles/enums.js\";import\"../engine/vectorTiles/shaders/sources/resolver.js\";import\"../engine/webgl/shaders/BitBlitPrograms.js\";import\"../engine/webgl/shaders/sources/resolver.js\";import\"../engine/webgl/TextureManager.js\";import\"../engine/webgl/shaders/StencilPrograms.js\";import\"../engine/webgl/effects/BlendEffect.js\";import\"../engine/webgl/shaders/HighlightPrograms.js\";import\"../engine/webgl/Profiler.js\";import\"../../webgl/renderState.js\";import\"../../3d/webgl-engine/core/shaderModules/interfaces.js\";import\"../../../core/floatRGBA.js\";import\"../../3d/webgl-engine/lib/OrderIndependentTransparency.js\";import\"../../../chunks/webgl-debug.js\";import\"../LabelManager.js\";import a from\"./graphics/GraphicsView2D.js\";import\"../engine/webgl/AttributeStoreView.js\";import\"../../../chunks/earcut.js\";import\"../../../layers/graphics/featureConversionUtils.js\";import\"../../../core/unitUtils.js\";import\"../../../renderers/support/lengthUtils.js\";import\"../../../chunks/vec3f32.js\";import\"../../../geometry/support/normalizeUtils.js\";import\"../navigation/MapViewNavigation.js\";import\"../../../core/asyncUtils.js\";import\"../engine/webgl/shaders/MagnifierPrograms.js\";import{BitmapTileLayerView2D as n}from\"./BitmapTileLayerView2D.js\";import{LayerView2DMixin as p}from\"./LayerView2D.js\";import g from\"./graphics/HighlightGraphicContainer.js\";import{createBlankImage as c,resampleImage as m}from\"./support/imageUtils.js\";import u from\"../tiling/TileInfoView.js\";import f from\"../tiling/TileKey.js\";import w from\"../tiling/TileQueue.js\";import d from\"../tiling/TileStrategy.js\";import j from\"../../layers/LayerView.js\";import y from\"../../layers/RefreshableLayerView.js\";import{isMapServiceLayerView as b,MapServiceLayerViewHelper as _}from\"../../layers/support/MapServiceLayerViewHelper.js\";import{createQueryGeometry as V}from\"../../support/drapedUtils.js\";const T=[0,0];let v=class extends(y(n(p(j)))){constructor(){super(...arguments),this._fetchQueue=null,this._highlightGraphics=new h,this._highlightView=null,this._popupHighlightHelper=null,this._tileStrategy=null,this.layer=null}get resampling(){return!(\"resampling\"in this.layer)||!1!==this.layer.resampling}update(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume(),this._highlightView?.processUpdate(e)}attach(){const e=\"tileServers\"in this.layer?this.layer.tileServers:null;if(this._tileInfoView=new u(this.layer.tileInfo,this.layer.fullExtent),this._fetchQueue=new w({tileInfoView:this._tileInfoView,concurrency:e&&10*e.length||10,process:(e,i)=>this.fetchTile(e,i)}),this._tileStrategy=new d({cachePolicy:\"keep\",resampling:this.resampling,acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),tileInfoView:this._tileInfoView}),b(this,this.layer)){const e=this._highlightView=new a({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new g(this.view.featuresTilingScheme),defaultPointSymbolEnabled:!1});this.container.addChild(this._highlightView.container),this._popupHighlightHelper=new _({createFetchPopupFeaturesQueryGeometry:(e,i)=>V(e,i,this.view),highlightGraphics:this._highlightGraphics,highlightGraphicUpdated:(i,t)=>{e.graphicUpdateHandler({graphic:i,property:t})},layerView:this,updatingHandles:this.updatingHandles})}this.requestUpdate(),this.addAttachHandles(r((()=>this.resampling),(()=>{this.doRefresh()}))),super.attach()}detach(){super.detach(),this._tileStrategy.destroy(),this._fetchQueue.clear(),this.container.removeAllChildren(),this._popupHighlightHelper?.destroy(),this._fetchQueue=this._tileStrategy=this._tileInfoView=this._popupHighlightHelper=null}async fetchPopupFeatures(e,i){return this._popupHighlightHelper?this._popupHighlightHelper.fetchPopupFeatures(e,i):[]}highlight(e){return this._popupHighlightHelper?this._popupHighlightHelper.highlight(e):{remove(){}}}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}supportsSpatialReference(e){return l(this.layer.tileInfo?.spatialReference,e)}async doRefresh(){!this.attached||this.updateRequested||this.suspended||(this._fetchQueue.reset(),this._tileStrategy.tiles.forEach((e=>this._enqueueTileFetch(e))))}isUpdating(){return this._fetchQueue?.updating??!1}acquireTile(e){const i=this._bitmapView.createTile(e),t=i.bitmap;return[t.x,t.y]=this._tileInfoView.getTileCoords(T,i.key),t.resolution=this._tileInfoView.getTileResolution(i.key),[t.width,t.height]=this._tileInfoView.tileInfo.size,this._enqueueTileFetch(i),this._bitmapView.addChild(i),this.requestUpdate(),i}releaseTile(e){this._fetchQueue.abort(e.key.id),this._bitmapView.removeChild(e),e.once(\"detach\",(()=>e.destroy())),this.requestUpdate()}async fetchTile(e,i={}){const r=\"tilemapCache\"in this.layer?this.layer.tilemapCache:null,{signal:s,resamplingLevel:o=0}=i;if(!r)try{return await this._fetchImage(e,s)}catch(a){if(!t(a)&&!this.resampling)return c(this._tileInfoView.tileInfo.size);if(o<3){const t=this._tileInfoView.getTileParentId(e.id);if(t){const r=new f(t),s=await this.fetchTile(r,{...i,resamplingLevel:o+1});return m(this._tileInfoView,s,r,e)}}throw a}const l=new f(0,0,0,0);let h;try{if(await r.fetchAvailabilityUpsample(e.level,e.row,e.col,l,{signal:s}),l.level!==e.level&&!this.resampling)return c(this._tileInfoView.tileInfo.size);h=await this._fetchImage(l,s)}catch(a){if(t(a))throw a;h=await this._fetchImage(e,s)}return this.resampling?m(this._tileInfoView,h,l,e):h}async _enqueueTileFetch(e){if(!this._fetchQueue.has(e.key.id)){try{const i=await this._fetchQueue.push(e.key);e.bitmap.source=i,e.bitmap.width=this._tileInfoView.tileInfo.size[0],e.bitmap.height=this._tileInfoView.tileInfo.size[1],e.once(\"attach\",(()=>this.requestUpdate()))}catch(r){t(r)||i.getLogger(this.declaredClass).error(r)}this.requestUpdate()}}async _fetchImage(e,i){return this.layer.fetchImageBitmapTile(e.level,e.row,e.col,{signal:i})}};e([s()],v.prototype,\"_fetchQueue\",void 0),e([s()],v.prototype,\"resampling\",null),v=e([o(\"esri.views.2d.layers.TileLayerView2D\")],v);const I=v;export{I as default};\n"],"names":["T","v","_y","_inherits","_super","_createSuper","_this","_classCallCheck","apply","arguments","_fetchQueue","_highlightGraphics","h","_highlightView","_popupHighlightHelper","_tileStrategy","layer","_createClass","key","get","this","resampling","value","e","_this$_highlightView","pause","state","update","resume","processUpdate","_this2","tileServers","_tileInfoView","u","tileInfo","fullExtent","w","tileInfoView","concurrency","length","process","i","fetchTile","d","cachePolicy","acquireTile","releaseTile","b","a","view","graphics","requestUpdateCallback","requestUpdate","container","g","featuresTilingScheme","defaultPointSymbolEnabled","addChild","_","createFetchPopupFeaturesQueryGeometry","V","highlightGraphics","highlightGraphicUpdated","t","graphicUpdateHandler","graphic","property","layerView","updatingHandles","addAttachHandles","r","doRefresh","_get","_getPrototypeOf","prototype","call","_this$_popupHighlight","destroy","clear","removeAllChildren","_fetchPopupFeatures","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","abrupt","fetchPopupFeatures","stop","_x","_x2","highlight","remove","_this$layer$tileInfo","l","spatialReference","_doRefresh","_callee2","_this3","_context2","attached","updateRequested","suspended","reset","tiles","forEach","_enqueueTileFetch","_this$_fetchQueue$upd","_this$_fetchQueue","updating","_this$_tileInfoView$g","_this$_tileInfoView$g2","_this$_tileInfoView$t","_bitmapView","createTile","bitmap","getTileCoords","_slicedToArray","x","y","resolution","getTileResolution","size","width","height","abort","id","removeChild","once","_fetchTile","_callee3","s","_i$resamplingLevel","o","_t","_r","_s","_args3","_context3","undefined","tilemapCache","signal","resamplingLevel","_fetchImage","sent","t0","c","getTileParentId","f","_objectSpread","m","fetchAvailabilityUpsample","level","row","col","t1","_x3","_enqueueTileFetch2","_callee4","_i","_this4","_context4","has","push","source","declaredClass","error","_x4","_fetchImage2","_callee5","_context5","fetchImageBitmapTile","_x5","_x6","n","p","j","I"],"sourceRoot":""}