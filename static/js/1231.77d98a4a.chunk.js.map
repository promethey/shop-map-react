{"version":3,"file":"static/js/1231.77d98a4a.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/support/ExportImageParameters.js","../node_modules/@arcgis/core/views/2d/layers/MapImageLayerView2D.js","../node_modules/@arcgis/core/views/layers/MapImageLayerView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Accessor.js\";import{HandleOwnerMixin as s}from\"../../core/HandleOwner.js\";import{isSome as t}from\"../../core/maybe.js\";import{sqlAnd as i}from\"../../core/sql.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as l}from\"./commonProperties.js\";import{getLayerFloorFilterClause as n}from\"./floorFilterUtils.js\";import{isExportDynamic as y}from\"./sublayerUtils.js\";const m={visible:\"visibleSublayers\",definitionExpression:\"layerDefs\",labelingInfo:\"hasDynamicLayers\",labelsVisible:\"hasDynamicLayers\",opacity:\"hasDynamicLayers\",minScale:\"visibleSublayers\",maxScale:\"visibleSublayers\",renderer:\"hasDynamicLayers\",source:\"hasDynamicLayers\"};let c=class extends(s(r)){constructor(e){super(e),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map((e=>{const r=n(this.floors,e);return e.toExportImageJSON(r)}));return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&y(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(e){this._get(\"layer\")!==e&&(this._set(\"layer\",e),this.handles.remove(\"layer\"),e&&this.handles.add([e.allSublayers.on(\"change\",(()=>this.notifyChange(\"visibleSublayers\"))),e.on(\"sublayer-update\",(e=>this.notifyChange(m[e.propertyName])))],\"layer\"))}get layers(){const e=this.visibleSublayers;return e?e.length?\"show:\"+e.map((e=>e.id)).join(\",\"):\"show:-1\":null}get layerDefs(){const e=!!this.floors?.length,r=this.visibleSublayers.filter((r=>null!=r.definitionExpression||e&&null!=r.floorInfo));return r.length?JSON.stringify(r.reduce(((e,r)=>{const s=n(this.floors,r),o=i(s,r.definitionExpression);return t(o)&&(e[r.id]=o),e}),{})):null}get version(){this.commitProperty(\"layers\"),this.commitProperty(\"layerDefs\"),this.commitProperty(\"dynamicLayers\"),this.commitProperty(\"timeExtent\");const e=this.layer;return e&&(e.commitProperty(\"dpi\"),e.commitProperty(\"imageFormat\"),e.commitProperty(\"imageTransparency\"),e.commitProperty(\"gdbVersion\")),(this._get(\"version\")||0)+1}get visibleSublayers(){const e=[];if(!this.layer)return e;const r=this.layer.sublayers,s=r=>{const t=this.scale,i=0===t,o=0===r.minScale||t<=r.minScale,a=0===r.maxScale||t>=r.maxScale;r.visible&&(i||o&&a)&&(r.sublayers?r.sublayers.forEach(s):e.unshift(r))};r&&r.forEach(s);const t=this._get(\"visibleSublayers\");return!t||t.length!==e.length||t.some(((r,s)=>e[s]!==r))?e:t}toJSON(){const e=this.layer;let r={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?r.dynamicLayers=this.dynamicLayers:r={...r,layers:this.layers,layerDefs:this.layerDefs},r}};e([o({readOnly:!0})],c.prototype,\"dynamicLayers\",null),e([o()],c.prototype,\"floors\",void 0),e([o({readOnly:!0})],c.prototype,\"hasDynamicLayers\",null),e([o()],c.prototype,\"layer\",null),e([o({readOnly:!0})],c.prototype,\"layers\",null),e([o({readOnly:!0})],c.prototype,\"layerDefs\",null),e([o({type:Number})],c.prototype,\"scale\",void 0),e([o(l)],c.prototype,\"timeExtent\",void 0),e([o({readOnly:!0})],c.prototype,\"version\",null),e([o({readOnly:!0})],c.prototype,\"visibleSublayers\",null),c=e([a(\"esri.layers.mixins.ExportImageParameters\")],c);export{c as ExportImageParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import e from\"../../../core/Logger.js\";import{isAbortError as i}from\"../../../core/promiseUtils.js\";import{watch as r}from\"../../../core/reactiveUtils.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{GraphicsCollection as h}from\"../../../support/GraphicsCollection.js\";import{BitmapContainer as o}from\"../engine/BitmapContainer.js\";import{LayerView2DMixin as p}from\"./LayerView2D.js\";import g from\"./graphics/GraphicsView2D.js\";import n from\"./graphics/HighlightGraphicContainer.js\";import l from\"./support/ExportStrategy.js\";import m from\"../../layers/LayerView.js\";import c from\"../../layers/MapImageLayerView.js\";import d from\"../../layers/RefreshableLayerView.js\";import{MapServiceLayerViewHelper as u}from\"../../layers/support/MapServiceLayerViewHelper.js\";import{createQueryGeometry as y}from\"../../support/drapedUtils.js\";let f=class extends(c(d(p(m)))){constructor(){super(...arguments),this._highlightGraphics=new h,this._updateHash=\"\"}fetchPopupFeatures(t,e){return this._popupHighlightHelper.fetchPopupFeatures(t,e)}update(t){const r=`${this.exportImageVersion}/${t.state.id}/${t.pixelRatio}/${t.stationary}`;this._updateHash!==r&&(this._updateHash=r,this.strategy.update(t).catch((t=>{i(t)||e.getLogger(this.declaredClass).error(t)})),t.stationary&&this._popupHighlightHelper.updateHighlightedFeatures(t.state.resolution)),this._highlightView.processUpdate(t)}attach(){const{imageMaxWidth:t,imageMaxHeight:e,version:i}=this.layer,s=i>=10.3,a=i>=10;this._bitmapContainer=new o,this.container.addChild(this._bitmapContainer),this._highlightView=new g({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new n(this.view.featuresTilingScheme),defaultPointSymbolEnabled:!1}),this.container.addChild(this._highlightView.container),this._popupHighlightHelper=new u({createFetchPopupFeaturesQueryGeometry:(t,e)=>y(t,e,this.view),highlightGraphics:this._highlightGraphics,highlightGraphicUpdated:(t,e)=>{this._highlightView.graphicUpdateHandler({graphic:t,property:e})},layerView:this,updatingHandles:this.updatingHandles}),this.strategy=new l({container:this._bitmapContainer,fetchSource:this.fetchImageBitmap.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:t,imageMaxHeight:e,imageRotationSupported:s,imageNormalizationSupported:a,hidpi:!0}),this.addAttachHandles(r((()=>this.exportImageVersion),(()=>this.requestUpdate()))),this.requestUpdate()}detach(){this.strategy.destroy(),this.container.removeAllChildren(),this._bitmapContainer.removeAllChildren(),this._highlightView.destroy(),this._popupHighlightHelper.destroy()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}supportsSpatialReference(t){return this.layer.serviceSupportsSpatialReference(t)}async doRefresh(){this._updateHash=\"\",this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(t,e,i,r){return this.layer.fetchImage(t,e,i,{timeExtent:this.timeExtent,floors:this.floors,...r})}fetchImageBitmap(t,e,i,r){return this.layer.fetchImageBitmap(t,e,i,{timeExtent:this.timeExtent,floors:this.floors,...r})}highlight(t){return this._popupHighlightHelper.highlight(t)}};t([s()],f.prototype,\"strategy\",void 0),t([s()],f.prototype,\"updating\",void 0),f=t([a(\"esri.views.2d.layers.MapImageLayerView2D\")],f);const w=f;export{w as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as o}from\"../../layers/support/commonProperties.js\";import{ExportImageParameters as s}from\"../../layers/support/ExportImageParameters.js\";const p=p=>{let a=class extends p{initialize(){this.exportImageParameters=new s({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get floors(){return this.view?.floors??null}get exportImageVersion(){return this.exportImageParameters?.commitProperty(\"version\"),this.commitProperty(\"timeExtent\"),this.commitProperty(\"floors\"),(this._get(\"exportImageVersion\")||0)+1}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return e([r()],a.prototype,\"exportImageParameters\",void 0),e([r({readOnly:!0})],a.prototype,\"floors\",null),e([r({readOnly:!0})],a.prototype,\"exportImageVersion\",null),e([r()],a.prototype,\"layer\",void 0),e([r()],a.prototype,\"suspended\",void 0),e([r(o)],a.prototype,\"timeExtent\",void 0),a=e([t(\"esri.views.layers.MapImageLayerView\")],a),a};export{p as default};\n"],"names":["m","visible","definitionExpression","labelingInfo","labelsVisible","opacity","minScale","maxScale","renderer","source","c","_s","_inherits","_super","_createSuper","e","_this","_classCallCheck","call","floors","scale","_createClass","key","value","this","layer","get","_this2","hasDynamicLayers","visibleSublayers","map","r","n","toExportImageJSON","length","JSON","stringify","y","serviceSublayers","gdbVersion","set","_this3","_get","_set","handles","remove","add","allSublayers","on","notifyChange","propertyName","id","join","_this$floors","_this4","filter","floorInfo","reduce","s","o","i","t","commitProperty","_this5","sublayers","forEach","a","unshift","some","dpi","format","imageFormat","transparent","imageTransparency","dynamicLayers","_objectSpread","layers","layerDefs","readOnly","prototype","type","Number","l","f","_c","apply","arguments","_highlightGraphics","h","_updateHash","_popupHighlightHelper","fetchPopupFeatures","concat","exportImageVersion","state","pixelRatio","stationary","strategy","update","catch","declaredClass","error","updateHighlightedFeatures","resolution","_highlightView","processUpdate","_this$layer","imageMaxWidth","imageMaxHeight","version","_bitmapContainer","container","addChild","g","view","graphics","requestUpdateCallback","requestUpdate","featuresTilingScheme","defaultPointSymbolEnabled","u","createFetchPopupFeaturesQueryGeometry","highlightGraphics","highlightGraphicUpdated","graphicUpdateHandler","graphic","property","layerView","updatingHandles","fetchSource","fetchImageBitmap","bind","imageRotationSupported","imageNormalizationSupported","hidpi","addAttachHandles","destroy","removeAllChildren","serviceSupportsSpatialReference","_doRefresh","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","stop","updating","updateRequested","fetchImage","timeExtent","highlight","p","_p","exportImageParameters","_this$view$floors","_this$view","_this$exportImagePara","_this$timeExtent","_getPrototypeOf","isEmpty","d","w"],"sourceRoot":""}