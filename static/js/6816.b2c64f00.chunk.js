"use strict";(self.webpackChunkshop_map_react=self.webpackChunkshop_map_react||[]).push([[6816],{46816:function(e,t,r){r.r(t),r.d(t,{default:function(){return M}});var n=r(74165),i=r(15861),a=r(1413),o=r(15671),s=r(43144),l=r(60136),u=r(29388),h=r(27366),c=r(76200),d=r(10064),p=r(92026),v=r(97642),f=r(66978),y=r(35995),_=r(49861),m=(r(25243),r(63780)),g=r(38511),k=r(69912),w=r(90724),b=r(30651),Z=r(17775),V=r(11936),C=r(6061),D=r(29598),S=r(45948),x=r(37762),T=function(){function e(t,r,n,i){(0,o.Z)(this,e),this._hasNoDataValues=null,this._minValue=null,this._maxValue=null,"pixelData"in t?(this.values=t.pixelData,this.width=t.width,this.height=t.height,this.noDataValue=t.noDataValue):(this.values=t,this.width=r,this.height=n,this.noDataValue=i)}return(0,s.Z)(e,[{key:"hasNoDataValues",get:function(){if((0,p.Wi)(this._hasNoDataValues)){var e=this.noDataValue;this._hasNoDataValues=this.values.includes(e)}return this._hasNoDataValues}},{key:"minValue",get:function(){return this._ensureBounds(),(0,p.Wg)(this._minValue)}},{key:"maxValue",get:function(){return this._ensureBounds(),(0,p.Wg)(this._maxValue)}},{key:"_ensureBounds",value:function(){if(!(0,p.pC)(this._minValue)){var e,t=this.noDataValue,r=this.values,n=1/0,i=-1/0,a=!0,o=(0,x.Z)(r);try{for(o.s();!(e=o.n()).done;){var s=e.value;s===t?this._hasNoDataValues=!0:(n=s<n?s:n,i=s>i?s:i,a=!1)}}catch(l){o.e(l)}finally{o.f()}a?(this._minValue=0,this._maxValue=0):(this._minValue=n,this._maxValue=i>-3e38?i:0)}}}]),e}(),L=r(42537),I=r(32718),N=r(31009),j=function(){function e(t,r,n,i){var s=this,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};(0,o.Z)(this,e),this._mainMethod=r,this._transferLists=n,this._listeners=[],this._promise=(0,N.bA)(t,(0,a.Z)((0,a.Z)({},l),{},{schedule:i})).then((function(e){if(void 0===s._thread){s._thread=e,s._promise=null,l.hasInitialize&&s.broadcast({},"initialize");var t,r=(0,x.Z)(s._listeners);try{for(r.s();!(t=r.n()).done;){var n=t.value;s._connectListener(n)}}catch(i){r.e(i)}finally{r.f()}}else e.close()})),this._promise.catch((function(e){return I.Z.getLogger("esri.core.workers.WorkerHandle").error("Failed to initialize ".concat(t," worker: ").concat(e))}))}return(0,s.Z)(e,[{key:"on",value:function(e,t){var r=this,n={removed:!1,eventName:e,callback:t,threadHandle:null};return this._listeners.push(n),this._connectListener(n),(0,L.kB)((function(){n.removed=!0,(0,m.Od)(r._listeners,n),r._thread&&(0,p.pC)(n.threadHandle)&&n.threadHandle.remove()}))}},{key:"destroy",value:function(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null}},{key:"invoke",value:function(e,t){return this.invokeMethod(this._mainMethod,e,t)}},{key:"invokeMethod",value:function(e,t,r){var n=this;if(this._thread){var i=this._transferLists[e],a=i?i(t):[];return this._thread.invoke(e,t,{transferList:a,signal:r})}return this._promise?this._promise.then((function(){return(0,f.k_)(r),n.invokeMethod(e,t,r)})):Promise.reject(null)}},{key:"broadcast",value:function(e,t){var r=this;return this._thread?Promise.all(this._thread.broadcast(t,e)).then((function(){})):this._promise?this._promise.then((function(){return r.broadcast(e,t)})):Promise.reject()}},{key:"promise",get:function(){return this._promise}},{key:"_connectListener",value:function(e){this._thread&&this._thread.on(e.eventName,e.callback).then((function(t){e.removed||(e.threadHandle=t)}))}}]),e}(),O=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,o.Z)(this,r),(e=t.call(this,"LercWorker","_decode",{_decode:function(e){return[e.buffer]}},n,{strategy:"dedicated"})).schedule=n,e.ref=0,e}return(0,s.Z)(r,[{key:"decode",value:function(e,t,r){return e&&0!==e.byteLength?this.invoke({buffer:e,options:t},r):Promise.resolve(null)}},{key:"release",value:function(){var e=this;--this.ref<=0&&(A.forEach((function(t,r){t===e&&A.delete(r)})),this.destroy())}}]),r}(j),A=new Map;var E=function(e){(0,l.Z)(h,e);var t=(0,u.Z)(h);function h(){var e;(0,o.Z)(this,h);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).copyright=null,e.heightModelInfo=null,e.path=null,e.minScale=void 0,e.maxScale=void 0,e.opacity=1,e.operationalLayerType="ArcGISTiledElevationServiceLayer",e.sourceJSON=null,e.type="elevation",e.url=null,e.version=null,e._lercDecoder=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=A.get((0,p.Wg)(e));return t||((0,p.pC)(e)?(t=new O((function(t){return e.immediate.schedule(t)})),A.set(e,t)):(t=new O,A.set(null,t))),++t.ref,t}(),e}return(0,s.Z)(h,[{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?(0,a.Z)({url:e},t):e}},{key:"destroy",value:function(){this._lercDecoder=(0,p.RY)(this._lercDecoder)}},{key:"readVersion",value:function(e,t){var r=t.currentVersion;return r||(r=9.3),r}},{key:"load",value:function(e){var t=this,r=(0,p.pC)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"],supportsData:!1,validateItem:function(e){for(var t=0;t<e.typeKeywords.length;t++)if("elevation 3d layer"===e.typeKeywords[t].toLowerCase())return!0;throw new d.Z("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}' ",{type:"Image Service",expectedType:"Image Service Elevation 3D Layer"})}},e).catch(f.r9).then((function(){return t._fetchImageService(r)}))),Promise.resolve(this)}},{key:"fetchTile",value:function(e,t,r,n){var i=this,a=(0,p.pC)((n=n||{signal:null}).signal)?n.signal:n.signal=(new AbortController).signal,o={responseType:"array-buffer",signal:a},s={noDataValue:n.noDataValue,returnFileInfo:!0};return this.load().then((function(){return i._fetchTileAvailability(e,t,r,n)})).then((function(){return(0,c.default)(i.getTileUrl(e,t,r),o)})).then((function(e){return i._lercDecoder.decode(e.data,s,a)})).then((function(e){return new T(e)}))}},{key:"getTileUrl",value:function(e,t,r){var n=!this.tilemapCache&&this.supportsBlankTile,i=(0,y.B7)((0,a.Z)((0,a.Z)({},this.parsedUrl.query),{},{blankTile:!n&&null}));return"".concat(this.parsedUrl.path,"/tile/").concat(e,"/").concat(t,"/").concat(r).concat(i?"?"+i:"")}},{key:"queryElevation",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,i){var a,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(5887).then(r.bind(r,35887));case 2:return a=e.sent,o=a.ElevationQuery,(0,f.k_)(i),e.abrupt("return",(new o).query(this,t,i));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createElevationSampler",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,i){var a,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(5887).then(r.bind(r,35887));case 2:return a=e.sent,o=a.ElevationQuery,(0,f.k_)(i),e.abrupt("return",(new o).createSampler(this,t,i));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_fetchTileAvailability",value:function(e,t,r,n){return this.tilemapCache?this.tilemapCache.fetchAvailability(e,t,r,n):Promise.resolve("unknown")}},{key:"_fetchImageService",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.sourceJSON){e.next=2;break}return e.abrupt("return",this.sourceJSON);case 2:return i={query:(0,a.Z)({f:"json"},this.parsedUrl.query),responseType:"json",signal:t},e.next=5,(0,c.default)(this.parsedUrl.path,i);case 5:(o=e.sent).ssl&&(this.url=null===(r=this.url)||void 0===r?void 0:r.replace(/^http:/i,"https:")),this.sourceJSON=o.data,this.read(o.data,{origin:"service",url:this.parsedUrl});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"hasOverriddenFetchTile",get:function(){return!this.fetchTile.__isDefault__}}]),h}((0,Z.Z)((0,V.Y)((0,C.q)((0,D.I)((0,v.R)(b.Z))))));(0,h._)([(0,_.Cb)({json:{read:{source:"copyrightText"}}})],E.prototype,"copyright",void 0),(0,h._)([(0,_.Cb)({readOnly:!0,type:w.Z})],E.prototype,"heightModelInfo",void 0),(0,h._)([(0,_.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],E.prototype,"path",void 0),(0,h._)([(0,_.Cb)({type:["show","hide"]})],E.prototype,"listMode",void 0),(0,h._)([(0,_.Cb)({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}},readOnly:!0})],E.prototype,"minScale",void 0),(0,h._)([(0,_.Cb)({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}},readOnly:!0})],E.prototype,"maxScale",void 0),(0,h._)([(0,_.Cb)({json:{read:!1,write:!1,origins:{"web-document":{read:!1,write:!1}}}})],E.prototype,"opacity",void 0),(0,h._)([(0,_.Cb)({type:["ArcGISTiledElevationServiceLayer"]})],E.prototype,"operationalLayerType",void 0),(0,h._)([(0,_.Cb)()],E.prototype,"sourceJSON",void 0),(0,h._)([(0,_.Cb)({json:{read:!1},value:"elevation",readOnly:!0})],E.prototype,"type",void 0),(0,h._)([(0,_.Cb)(S.HQ)],E.prototype,"url",void 0),(0,h._)([(0,_.Cb)()],E.prototype,"version",void 0),(0,h._)([(0,g.r)("version",["currentVersion"])],E.prototype,"readVersion",null),(E=(0,h._)([(0,k.j)("esri.layers.ElevationLayer")],E)).prototype.fetchTile.__isDefault__=!0;var M=E}}]);
//# sourceMappingURL=6816.b2c64f00.chunk.js.map